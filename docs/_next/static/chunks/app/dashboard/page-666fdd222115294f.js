(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{8986:function(e,t,a){Promise.resolve().then(a.bind(a,2435))},2435:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u}});var s=a(7821),r=a(8078),i=a(8504),l=a(6713);let o=(0,r.memo)(e=>{let{onClose:t}=e,{createTask:a,loadingState:i,error:o}=(0,l.q)(),{tasks:n}=i,[d,c]=(0,r.useState)(""),[u,m]=(0,r.useState)(""),h=async e=>{if(e.preventDefault(),!d.trim()){alert("Title is required");return}try{await a({title:d.trim(),description:u.trim(),completed:!1,updated_at:""}),c(""),m(""),t&&t()}catch(e){}};return(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg p-4 sm:p-6",role:"region","aria-labelledby":"task-form-title",children:[(0,s.jsx)("h3",{id:"task-form-title",className:"text-lg font-medium text-gray-900 mb-4",children:"Create New Task"}),o&&(0,s.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert","aria-live":"polite",children:(0,s.jsx)("span",{className:"block sm:inline",children:o})}),(0,s.jsxs)("form",{onSubmit:h,role:"form","aria-label":"Create new task form",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),(0,s.jsx)("input",{type:"text",id:"title",value:d,onChange:e=>c(e.target.value),className:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md p-2 text-gray-900",placeholder:"Task title",required:!0,"aria-describedby":"title-error"}),(0,s.jsx)("div",{id:"title-error",className:"sr-only","aria-live":"polite",children:d.trim()?"":"Title is required"})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,s.jsx)("textarea",{id:"description",value:u,onChange:e=>m(e.target.value),rows:3,className:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md p-2 text-gray-900",placeholder:"Task description (optional)","aria-label":"Task description"})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-end space-y-2 sm:space-y-0 sm:space-x-3",children:[t&&(0,s.jsx)("button",{type:"button",onClick:t,className:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:w-auto","aria-label":"Cancel creating task",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:n,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 sm:w-auto","aria-busy":n,children:n?"Creating...":"Create Task"})]})]})]})}),n=(0,r.memo)(e=>{let{task:t,onDelete:a,onToggle:i}=e,[o,n]=(0,r.useState)(!1),[d,c]=(0,r.useState)(t.title),[u,m]=(0,r.useState)(t.description||""),[h,x]=(0,r.useState)(!1),{updateTask:p}=(0,l.q)(),g=async()=>{if(d.trim()){x(!0);try{await p(t.id,{title:d,description:u}),n(!1)}catch(e){}finally{x(!1)}}};return(0,s.jsx)("div",{className:"p-4",role:"listitem",children:o?(0,s.jsxs)("div",{className:"border rounded-lg p-4 bg-white shadow-sm",role:"form","aria-label":"Editing task: ".concat(t.title),children:[(0,s.jsx)("label",{htmlFor:"edit-title",className:"sr-only",children:"Task Title"}),(0,s.jsx)("input",{id:"edit-title",type:"text",value:d,onChange:e=>c(e.target.value),className:"w-full p-2 border rounded mb-2 text-gray-900",placeholder:"Task title","aria-label":"Edit task title",autoFocus:!0}),(0,s.jsx)("label",{htmlFor:"edit-description",className:"sr-only",children:"Task Description"}),(0,s.jsx)("textarea",{id:"edit-description",value:u,onChange:e=>m(e.target.value),className:"w-full p-2 border rounded mb-2 text-gray-900",placeholder:"Task description",rows:2,"aria-label":"Edit task description"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2",children:[(0,s.jsx)("button",{onClick:()=>n(!1),className:"px-3 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 sm:w-auto",disabled:h,"aria-label":"Cancel editing",children:"Cancel"}),(0,s.jsx)("button",{onClick:g,className:"px-3 py-1 text-sm bg-indigo-600 text-white rounded hover:bg-indigo-700 sm:w-auto",disabled:h,"aria-label":"Save changes",children:h?"Saving...":"Save"})]})]}):(0,s.jsx)("div",{className:"border rounded-lg p-4 shadow-sm transition-all duration-200 ".concat(t.completed?"bg-gray-50":"bg-white hover:shadow-md"),children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("input",{type:"checkbox",checked:t.completed,onChange:()=>i(t.id),className:"h-5 w-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500 mt-0.5 cursor-pointer",id:"task-checkbox-".concat(t.id),"aria-label":t.completed?'Mark task "'.concat(t.title,'" as incomplete'):'Mark task "'.concat(t.title,'" as complete')}),(0,s.jsxs)("div",{className:"ml-3 flex-1 min-w-0",children:[(0,s.jsx)("label",{htmlFor:"task-checkbox-".concat(t.id),className:"text-base font-medium block ".concat(t.completed?"text-gray-500 line-through":"text-gray-900"),children:t.title}),t.description&&(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1","aria-label":"Description: ".concat(t.description),children:t.description})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-end sm:items-center sm:space-x-2 space-y-2 sm:space-y-0",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500 self-start sm:self-auto","aria-label":"Created on ".concat(new Date(t.created_at).toLocaleDateString()),children:new Date(t.created_at).toLocaleDateString()}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>n(!0),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-50","aria-label":'Edit task "'.concat(t.title,'"'),children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,s.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),(0,s.jsx)("button",{onClick:()=>a(t.id),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-50","aria-label":'Delete task "'.concat(t.title,'"'),children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]})]})})})},(e,t)=>e.task.id===t.task.id&&e.task.title===t.task.title&&e.task.description===t.task.description&&e.task.completed===t.task.completed&&e.task.created_at===t.task.created_at&&e.task.updated_at===t.task.updated_at),d=e=>{let{size:t="md",text:a}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)("div",{className:"".concat({sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[t]," animate-spin rounded-full border-2 border-current border-t-transparent text-indigo-600"),role:"status",children:(0,s.jsx)("span",{className:"sr-only",children:"Loading..."})}),a&&(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:a})]})},c=(0,r.memo)(()=>{let{user:e,tasks:t,loadingState:a,error:i,fetchTasks:o,deleteTask:c,toggleTaskCompletion:u}=(0,l.q)(),[m,h]=(0,r.useState)("all");(0,r.useEffect)(()=>{(null==e?void 0:e.user_id)&&o()},[null==e?void 0:e.user_id]);let x=t.filter(e=>"active"===m?!e.completed:"completed"!==m||e.completed);return a.tasks&&0===t.length?(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)(d,{size:"lg",text:"Loading tasks..."})}):i?(0,s.jsxs)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 mb-4",children:[(0,s.jsxs)("p",{className:"text-sm text-red-700",children:[(0,s.jsx)("span",{className:"font-medium",children:"Error:"})," ",i]}),(0,s.jsx)("button",{onClick:o,className:"mt-2 text-sm text-red-600 underline",children:"Retry"})]}):(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,s.jsxs)("div",{className:"p-4 border-b flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Tasks"}),(0,s.jsx)("div",{className:"flex space-x-2",children:["all","active","completed"].map(e=>(0,s.jsx)("button",{onClick:()=>h(e),className:"px-3 py-1 text-sm rounded-md ".concat(m===e?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700"),children:e[0].toUpperCase()+e.slice(1)},e))})]}),a.tasks&&t.length>0?(0,s.jsx)("div",{className:"p-4 flex justify-center",children:(0,s.jsx)(d,{size:"sm",text:"Updating tasks..."})}):0===x.length?(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No tasks found."}):(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)("ul",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.map(e=>(0,s.jsx)("li",{children:(0,s.jsx)(n,{task:e,onDelete:c,onToggle:u},e.id)},e.id))})})]})});var u=()=>{let e=(0,i.useRouter)(),{user:t,loadingState:a,signOut:n}=(0,l.q)(),[d,u]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{a.auth||t||e.push("/")},[t,a.auth,e]),a.auth||!t)?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("header",{className:"bg-white shadow",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Todo Dashboard"}),(0,s.jsxs)("div",{className:"flex items-center justify-between w-full sm:w-auto gap-4",children:[(0,s.jsxs)("span",{className:"text-gray-700 text-sm sm:text-base",children:["Welcome, ",t.email.split("@")[0]]}),(0,s.jsx)("button",{onClick:()=>u(!d),className:"sm:hidden bg-indigo-600 text-white px-3 py-1.5 rounded-md text-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:d?"Cancel":"+"}),(0,s.jsx)("button",{onClick:()=>{n(),e.push("/")},className:"bg-red-600 text-white px-3 py-1.5 rounded-md text-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 whitespace-nowrap",children:"Logout"})]})]})})}),(0,s.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 gap-4",children:[(0,s.jsx)("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:"Your Tasks"}),(0,s.jsx)("button",{onClick:()=>u(!d),className:"hidden sm:block bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:d?"Cancel":"Add New Task"})]}),d&&(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)(o,{onClose:()=>u(!1)})}),(0,s.jsx)(c,{})]})]})}},6713:function(e,t,a){"use strict";a.d(t,{AppProvider:function(){return c},q:function(){return u}});var s=a(7821),r=a(8078);class i{async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new AbortController,s="".concat(this.baseUrl).concat(e),r={...t.headers||{}};t.body&&(r["Content-Type"]="application/json");try{let e=await fetch(s,{...t,headers:r,signal:a.signal});if(!e.ok){let t="HTTP ".concat(e.status);try{t=(await e.json()).detail||t}catch(e){}if(401===e.status)throw Error("Unauthorized");throw Error(t)}if(204===e.status)return null;return e.json()}catch(e){if("AbortError"===e.name)return;throw e}}signIn(e,t){return this.request("/auth/signin",{method:"POST",body:JSON.stringify({email:e,password:t})})}signUp(e,t){return this.request("/auth/signup",{method:"POST",body:JSON.stringify({email:e,password:t})})}signOut(){return Promise.resolve()}getTasks(e){return this.request("/tasks",{headers:{Authorization:"Bearer ".concat(e)}})}getTaskById(e,t){return this.request("/tasks/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})}createTask(e,t){return this.request("/tasks",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)})}updateTask(e,t,a){return this.request("/tasks/".concat(e),{method:"PUT",headers:{Authorization:"Bearer ".concat(a)},body:JSON.stringify(t)})}deleteTask(e,t){return this.request("/tasks/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})}toggleTaskCompletion(e,t){return this.request("/tasks/".concat(e,"/toggle"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t)}})}constructor(){var e;e="https://full-stack-todo-web-application-fro.vercel.app/api",this.baseUrl=void 0!==e?e:"http://127.0.0.1:8000/api"}}let l=new i,o={user:null,token:null,tasks:[],loadingState:{auth:!1,tasks:!1},error:null},n=(e,t)=>{switch(t.type){case"SET_USER":return{...e,user:t.payload.user,token:t.payload.token,error:null};case"LOGOUT":return{...o};case"SET_TASKS":return{...e,tasks:t.payload,loadingState:{...e.loadingState,tasks:!1}};case"ADD_TASK":return{...e,tasks:[...e.tasks,t.payload]};case"UPDATE_TASK":return{...e,tasks:e.tasks.map(e=>e.id===t.payload.id?t.payload:e)};case"DELETE_TASK":return{...e,tasks:e.tasks.filter(e=>e.id!==t.payload)};case"SET_LOADING":return{...e,loadingState:{...e.loadingState,[t.payload.section]:t.payload.value}};case"SET_ERROR":return{...e,error:t.payload,loadingState:{auth:!1,tasks:!1}};default:return e}},d=(0,r.createContext)(void 0),c=e=>{let{children:t}=e,[a,i]=(0,r.useReducer)(n,o);(0,r.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");if(e&&t)try{i({type:"SET_USER",payload:{token:e,user:JSON.parse(t)}})}catch(e){localStorage.clear()}},[]);let c=async(e,t)=>{i({type:"SET_LOADING",payload:{section:"auth",value:!0}});try{let a=await l.signIn(e,t);localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify({user_id:a.user_id,email:a.email})),i({type:"SET_USER",payload:{token:a.token,user:{user_id:a.user_id,email:a.email}}})}catch(e){throw i({type:"SET_ERROR",payload:e.message}),e}finally{i({type:"SET_LOADING",payload:{section:"auth",value:!1}})}},u=async(e,t)=>{i({type:"SET_LOADING",payload:{section:"auth",value:!0}});try{let a=await l.signUp(e,t);localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify({user_id:a.user_id,email:a.email})),i({type:"SET_USER",payload:{token:a.token,user:{user_id:a.user_id,email:a.email}}})}catch(e){throw i({type:"SET_ERROR",payload:e.message}),e}finally{i({type:"SET_LOADING",payload:{section:"auth",value:!1}})}},m=async()=>{if(a.token){i({type:"SET_LOADING",payload:{section:"tasks",value:!0}});try{let e=await l.getTasks(a.token);i({type:"SET_TASKS",payload:e})}catch(e){i({type:"SET_ERROR",payload:e.message})}}},h=async e=>{a.token&&i({type:"ADD_TASK",payload:await l.createTask(e,a.token)})},x=async(e,t)=>{a.token&&i({type:"UPDATE_TASK",payload:await l.updateTask(e,t,a.token)})},p=async e=>{a.token&&(await l.deleteTask(e,a.token),i({type:"DELETE_TASK",payload:e}))},g=async e=>{a.token&&i({type:"UPDATE_TASK",payload:await l.toggleTaskCompletion(e,a.token)})};return(0,s.jsx)(d.Provider,{value:{...a,signIn:c,signUp:u,signOut:()=>{localStorage.clear(),i({type:"LOGOUT"})},fetchTasks:m,createTask:h,updateTask:x,deleteTask:p,toggleTaskCompletion:g},children:t})},u=()=>{let e=(0,r.useContext)(d);if(!e)throw Error("useApp must be used inside AppProvider");return e}},8504:function(e,t,a){"use strict";var s=a(3226);a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[115,364,744],function(){return e(e.s=8986)}),_N_E=e.O()}]);