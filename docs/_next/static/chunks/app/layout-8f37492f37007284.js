(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{9721:function(e,t,a){Promise.resolve().then(a.bind(a,6713)),Promise.resolve().then(a.t.bind(a,7754,23)),Promise.resolve().then(a.t.bind(a,6866,23))},6713:function(e,t,a){"use strict";a.d(t,{AppProvider:function(){return c},q:function(){return d}});var r=a(7821),s=a(8078);class o{async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new AbortController,r="".concat(this.baseUrl).concat(e),s={...t.headers||{}};t.body&&(s["Content-Type"]="application/json");try{let e=await fetch(r,{...t,headers:s,signal:a.signal});if(!e.ok){let t="HTTP ".concat(e.status);try{t=(await e.json()).detail||t}catch(e){}if(401===e.status)throw Error("Unauthorized");throw Error(t)}if(204===e.status)return null;return e.json()}catch(e){if("AbortError"===e.name)return;throw e}}signIn(e,t){return this.request("/auth/signin",{method:"POST",body:JSON.stringify({email:e,password:t})})}signUp(e,t){return this.request("/auth/signup",{method:"POST",body:JSON.stringify({email:e,password:t})})}signOut(){return Promise.resolve()}getTasks(e){return this.request("/tasks",{headers:{Authorization:"Bearer ".concat(e)}})}getTaskById(e,t){return this.request("/tasks/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})}createTask(e,t){return this.request("/tasks",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)})}updateTask(e,t,a){return this.request("/tasks/".concat(e),{method:"PUT",headers:{Authorization:"Bearer ".concat(a)},body:JSON.stringify(t)})}deleteTask(e,t){return this.request("/tasks/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})}toggleTaskCompletion(e,t){return this.request("/tasks/".concat(e,"/toggle"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t)}})}constructor(){var e;e="https://full-stack-todo-web-application-fro.vercel.app/api",this.baseUrl=void 0!==e?e:"https://todo-backend-delta-six.vercel.app/api"}}let n=new o,i={user:null,token:null,tasks:[],loadingState:{auth:!1,tasks:!1},error:null},l=(e,t)=>{switch(t.type){case"SET_USER":return{...e,user:t.payload.user,token:t.payload.token,error:null};case"LOGOUT":return{...i};case"SET_TASKS":return{...e,tasks:t.payload,loadingState:{...e.loadingState,tasks:!1}};case"ADD_TASK":return{...e,tasks:[...e.tasks,t.payload]};case"UPDATE_TASK":return{...e,tasks:e.tasks.map(e=>e.id===t.payload.id?t.payload:e)};case"DELETE_TASK":return{...e,tasks:e.tasks.filter(e=>e.id!==t.payload)};case"SET_LOADING":return{...e,loadingState:{...e.loadingState,[t.payload.section]:t.payload.value}};case"SET_ERROR":return{...e,error:t.payload,loadingState:{auth:!1,tasks:!1}};default:return e}},u=(0,s.createContext)(void 0),c=e=>{let{children:t}=e,[a,o]=(0,s.useReducer)(l,i);(0,s.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");if(e&&t)try{o({type:"SET_USER",payload:{token:e,user:JSON.parse(t)}})}catch(e){localStorage.clear()}},[]);let c=async(e,t)=>{o({type:"SET_LOADING",payload:{section:"auth",value:!0}});try{let a=await n.signIn(e,t);localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify({user_id:a.user_id,email:a.email})),o({type:"SET_USER",payload:{token:a.token,user:{user_id:a.user_id,email:a.email}}})}catch(e){throw o({type:"SET_ERROR",payload:e.message}),e}finally{o({type:"SET_LOADING",payload:{section:"auth",value:!1}})}},d=async(e,t)=>{o({type:"SET_LOADING",payload:{section:"auth",value:!0}});try{let a=await n.signUp(e,t);localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify({user_id:a.user_id,email:a.email})),o({type:"SET_USER",payload:{token:a.token,user:{user_id:a.user_id,email:a.email}}})}catch(e){throw o({type:"SET_ERROR",payload:e.message}),e}finally{o({type:"SET_LOADING",payload:{section:"auth",value:!1}})}},p=async()=>{if(a.token){o({type:"SET_LOADING",payload:{section:"tasks",value:!0}});try{let e=await n.getTasks(a.token);o({type:"SET_TASKS",payload:e})}catch(e){o({type:"SET_ERROR",payload:e.message})}}},y=async e=>{a.token&&o({type:"ADD_TASK",payload:await n.createTask(e,a.token)})},h=async(e,t)=>{a.token&&o({type:"UPDATE_TASK",payload:await n.updateTask(e,t,a.token)})},k=async e=>{a.token&&(await n.deleteTask(e,a.token),o({type:"DELETE_TASK",payload:e}))},S=async e=>{a.token&&o({type:"UPDATE_TASK",payload:await n.toggleTaskCompletion(e,a.token)})};return(0,r.jsx)(u.Provider,{value:{...a,signIn:c,signUp:d,signOut:()=>{localStorage.clear(),o({type:"LOGOUT"})},fetchTasks:p,createTask:y,updateTask:h,deleteTask:k,toggleTaskCompletion:S},children:t})},d=()=>{let e=(0,s.useContext)(u);if(!e)throw Error("useApp must be used inside AppProvider");return e}},6866:function(){},7754:function(e){e.exports={style:{fontFamily:"'__Inter_a12e57', '__Inter_Fallback_a12e57'",fontStyle:"normal"},className:"__className_a12e57"}}},function(e){e.O(0,[884,115,364,744],function(){return e(e.s=9721)}),_N_E=e.O()}]);