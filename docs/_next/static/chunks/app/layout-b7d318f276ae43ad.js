(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{9721:function(t,e,a){Promise.resolve().then(a.bind(a,6713)),Promise.resolve().then(a.t.bind(a,7754,23)),Promise.resolve().then(a.t.bind(a,6866,23))},6713:function(t,e,a){"use strict";a.d(e,{AppProvider:function(){return c},q:function(){return d}});var r=a(7821),s=a(8078);class o{async request(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new AbortController,r="".concat(this.baseUrl).concat(t),s={...e.headers||{}};e.body&&(s["Content-Type"]="application/json");try{let t=await fetch(r,{...e,headers:s,signal:a.signal});if(!t.ok){let e="HTTP ".concat(t.status);try{e=(await t.json()).detail||e}catch(t){}if(401===t.status)throw Error("Unauthorized");throw Error(e)}if(204===t.status)return null;return t.json()}catch(t){if("AbortError"===t.name)return;throw t}}signIn(t,e){return this.request("/auth/signin",{method:"POST",body:JSON.stringify({email:t,password:e})})}signUp(t,e){return this.request("/auth/signup",{method:"POST",body:JSON.stringify({email:t,password:e})})}signOut(){return Promise.resolve()}getTasks(t){return this.request("/tasks",{headers:{Authorization:"Bearer ".concat(t)}})}getTaskById(t,e){return this.request("/tasks/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}})}createTask(t,e){return this.request("/tasks",{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:JSON.stringify(t)})}updateTask(t,e,a){return this.request("/tasks/".concat(t),{method:"PUT",headers:{Authorization:"Bearer ".concat(a)},body:JSON.stringify(e)})}deleteTask(t,e){return this.request("/tasks/".concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}})}toggleTaskCompletion(t,e){return this.request("/tasks/".concat(t,"/toggle"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(e)}})}constructor(){var t;t="https://full-stack-todo-web-application-fro.vercel.app/api",this.baseUrl=void 0!==t?t:"http://127.0.0.1:8000/api"}}let n=new o,i={user:null,token:null,tasks:[],loadingState:{auth:!1,tasks:!1},error:null},l=(t,e)=>{switch(e.type){case"SET_USER":return{...t,user:e.payload.user,token:e.payload.token,error:null};case"LOGOUT":return{...i};case"SET_TASKS":return{...t,tasks:e.payload,loadingState:{...t.loadingState,tasks:!1}};case"ADD_TASK":return{...t,tasks:[...t.tasks,e.payload]};case"UPDATE_TASK":return{...t,tasks:t.tasks.map(t=>t.id===e.payload.id?e.payload:t)};case"DELETE_TASK":return{...t,tasks:t.tasks.filter(t=>t.id!==e.payload)};case"SET_LOADING":return{...t,loadingState:{...t.loadingState,[e.payload.section]:e.payload.value}};case"SET_ERROR":return{...t,error:e.payload,loadingState:{auth:!1,tasks:!1}};default:return t}},u=(0,s.createContext)(void 0),c=t=>{let{children:e}=t,[a,o]=(0,s.useReducer)(l,i);(0,s.useEffect)(()=>{let t=localStorage.getItem("token"),e=localStorage.getItem("user");if(t&&e)try{o({type:"SET_USER",payload:{token:t,user:JSON.parse(e)}})}catch(t){localStorage.clear()}},[]);let c=async(t,e)=>{o({type:"SET_LOADING",payload:{section:"auth",value:!0}});try{let a=await n.signIn(t,e);localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify({user_id:a.user_id,email:a.email})),o({type:"SET_USER",payload:{token:a.token,user:{user_id:a.user_id,email:a.email}}})}catch(t){throw o({type:"SET_ERROR",payload:t.message}),t}finally{o({type:"SET_LOADING",payload:{section:"auth",value:!1}})}},d=async(t,e)=>{o({type:"SET_LOADING",payload:{section:"auth",value:!0}});try{let a=await n.signUp(t,e);localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify({user_id:a.user_id,email:a.email})),o({type:"SET_USER",payload:{token:a.token,user:{user_id:a.user_id,email:a.email}}})}catch(t){throw o({type:"SET_ERROR",payload:t.message}),t}finally{o({type:"SET_LOADING",payload:{section:"auth",value:!1}})}},y=async()=>{if(a.token){o({type:"SET_LOADING",payload:{section:"tasks",value:!0}});try{let t=await n.getTasks(a.token);o({type:"SET_TASKS",payload:t})}catch(t){o({type:"SET_ERROR",payload:t.message})}}},p=async t=>{a.token&&o({type:"ADD_TASK",payload:await n.createTask(t,a.token)})},h=async(t,e)=>{a.token&&o({type:"UPDATE_TASK",payload:await n.updateTask(t,e,a.token)})},k=async t=>{a.token&&(await n.deleteTask(t,a.token),o({type:"DELETE_TASK",payload:t}))},S=async t=>{a.token&&o({type:"UPDATE_TASK",payload:await n.toggleTaskCompletion(t,a.token)})};return(0,r.jsx)(u.Provider,{value:{...a,signIn:c,signUp:d,signOut:()=>{localStorage.clear(),o({type:"LOGOUT"})},fetchTasks:y,createTask:p,updateTask:h,deleteTask:k,toggleTaskCompletion:S},children:e})},d=()=>{let t=(0,s.useContext)(u);if(!t)throw Error("useApp must be used inside AppProvider");return t}},6866:function(){},7754:function(t){t.exports={style:{fontFamily:"'__Inter_a12e57', '__Inter_Fallback_a12e57'",fontStyle:"normal"},className:"__className_a12e57"}}},function(t){t.O(0,[884,115,364,744],function(){return t(t.s=9721)}),_N_E=t.O()}]);