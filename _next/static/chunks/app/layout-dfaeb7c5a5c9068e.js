(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{9721:function(t,e,a){Promise.resolve().then(a.bind(a,6713)),Promise.resolve().then(a.t.bind(a,7754,23)),Promise.resolve().then(a.t.bind(a,6866,23))},6713:function(t,e,a){"use strict";a.d(e,{AppProvider:function(){return u},q:function(){return d}});var s=a(7821),r=a(8078);class o{async request(t){let e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s="".concat(this.baseUrl).concat(t),r={...a.headers||{}};a.body&&(r["Content-Type"]="application/json");try{e=await fetch(s,{...a,headers:r})}catch(t){throw t}if(!e.ok){let t="HTTP ".concat(e.status);try{var o;let a=await e.json();t=null!==(o=a.detail)&&void 0!==o?o:t}catch(t){}throw Error(t)}return 204===e.status?null:await e.json()}async signIn(t,e){return await this.request("/auth/signin",{method:"POST",body:JSON.stringify({email:t,password:e})})}async signUp(t,e){return await this.request("/auth/signup",{method:"POST",body:JSON.stringify({email:t,password:e})})}signOut(){return Promise.resolve()}async getTasks(t){return await this.request("/tasks",{headers:{Authorization:"Bearer ".concat(t)}})}async getTaskById(t,e){return await this.request("/tasks/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}})}async createTask(t,e){return await this.request("/tasks",{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:JSON.stringify(t)})}async updateTask(t,e,a){return await this.request("/tasks/".concat(t),{method:"PUT",headers:{Authorization:"Bearer ".concat(a)},body:JSON.stringify(e)})}async deleteTask(t,e){return await this.request("/tasks/".concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}})}async toggleTaskCompletion(t,e){return await this.request("/tasks/".concat(t,"/toggle"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(e)}})}constructor(){var t;t="https://todo-backend-delta-six.vercel.app/api",this.baseUrl=void 0!==t?t:"https://todo-backend-delta-six.vercel.app"}}let n=new o,i={user:null,token:null,tasks:[],loadingState:{auth:!1,tasks:!1},error:null},l=(t,e)=>{switch(e.type){case"SET_USER":return{...t,user:e.payload.user,token:e.payload.token,error:null};case"LOGOUT":return{...i};case"SET_TASKS":return{...t,tasks:e.payload,loadingState:{...t.loadingState,tasks:!1}};case"ADD_TASK":return{...t,tasks:[...t.tasks,e.payload]};case"UPDATE_TASK":return{...t,tasks:t.tasks.map(t=>t.id===e.payload.id?e.payload:t)};case"DELETE_TASK":return{...t,tasks:t.tasks.filter(t=>t.id!==e.payload)};case"SET_LOADING":return{...t,loadingState:{...t.loadingState,[e.payload.section]:e.payload.value}};case"SET_ERROR":return{...t,error:e.payload,loadingState:{auth:!1,tasks:!1}};default:return t}},c=(0,r.createContext)(void 0),u=t=>{let{children:e}=t,[a,o]=(0,r.useReducer)(l,i);(0,r.useEffect)(()=>{let t=localStorage.getItem("token"),e=localStorage.getItem("user");if(t&&e)try{o({type:"SET_USER",payload:{token:t,user:JSON.parse(e)}})}catch(t){localStorage.clear()}},[]);let u=async(t,e)=>{o({type:"SET_LOADING",payload:{section:"auth",value:!0}});try{let a=await n.signIn(t,e);return localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify({user_id:a.user_id,email:a.email})),o({type:"SET_USER",payload:{token:a.token,user:{user_id:a.user_id,email:a.email}}}),a}catch(t){throw o({type:"SET_ERROR",payload:t.message}),t}finally{o({type:"SET_LOADING",payload:{section:"auth",value:!1}})}},d=async(t,e)=>{o({type:"SET_LOADING",payload:{section:"auth",value:!0}});try{let a=await n.signUp(t,e);return localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify({user_id:a.user_id,email:a.email})),o({type:"SET_USER",payload:{token:a.token,user:{user_id:a.user_id,email:a.email}}}),a}catch(t){throw o({type:"SET_ERROR",payload:t.message}),t}finally{o({type:"SET_LOADING",payload:{section:"auth",value:!1}})}},y=async()=>{if(a.token){o({type:"SET_LOADING",payload:{section:"tasks",value:!0}});try{let t=await n.getTasks(a.token);o({type:"SET_TASKS",payload:t})}catch(t){o({type:"SET_ERROR",payload:t.message})}}},p=async t=>{a.token&&o({type:"ADD_TASK",payload:await n.createTask(t,a.token)})},h=async(t,e)=>{a.token&&o({type:"UPDATE_TASK",payload:await n.updateTask(t,e,a.token)})},k=async t=>{a.token&&(await n.deleteTask(t,a.token),o({type:"DELETE_TASK",payload:t}))},S=async t=>{a.token&&o({type:"UPDATE_TASK",payload:await n.toggleTaskCompletion(t,a.token)})};return(0,s.jsx)(c.Provider,{value:{...a,signIn:u,signUp:d,signOut:()=>{localStorage.clear(),o({type:"LOGOUT"})},fetchTasks:y,createTask:p,updateTask:h,deleteTask:k,toggleTaskCompletion:S},children:e})},d=()=>{let t=(0,r.useContext)(c);if(!t)throw Error("useApp must be used inside AppProvider");return t}},6866:function(){},7754:function(t){t.exports={style:{fontFamily:"'__Inter_a12e57', '__Inter_Fallback_a12e57'",fontStyle:"normal"},className:"__className_a12e57"}}},function(t){t.O(0,[884,115,364,744],function(){return t(t.s=9721)}),_N_E=t.O()}]);