(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{8986:function(e,t,s){Promise.resolve().then(s.bind(s,2435))},2435:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var a=s(7821),r=s(8078),i=s(8504),n=s(6713);let l=(0,r.memo)(e=>{let{onClose:t}=e,{createTask:s,loadingState:i,error:l}=(0,n.q)(),{tasks:o}=i,[c,d]=(0,r.useState)(""),[u,m]=(0,r.useState)(""),h=async e=>{if(e.preventDefault(),!c.trim()){alert("Title is required");return}try{await s({title:c.trim(),description:u.trim(),completed:!1,updated_at:""}),d(""),m(""),t&&t()}catch(e){}};return(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-4 sm:p-6",role:"region","aria-labelledby":"task-form-title",children:[(0,a.jsx)("h3",{id:"task-form-title",className:"text-lg font-medium text-gray-900 mb-4",children:"Create New Task"}),l&&(0,a.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert","aria-live":"polite",children:(0,a.jsx)("span",{className:"block sm:inline",children:l})}),(0,a.jsxs)("form",{onSubmit:h,role:"form","aria-label":"Create new task form",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),(0,a.jsx)("input",{type:"text",id:"title",value:c,onChange:e=>d(e.target.value),className:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md p-2 text-gray-900",placeholder:"Task title",required:!0,"aria-describedby":"title-error"}),(0,a.jsx)("div",{id:"title-error",className:"sr-only","aria-live":"polite",children:c.trim()?"":"Title is required"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,a.jsx)("textarea",{id:"description",value:u,onChange:e=>m(e.target.value),rows:3,className:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md p-2 text-gray-900",placeholder:"Task description (optional)","aria-label":"Task description"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-end space-y-2 sm:space-y-0 sm:space-x-3",children:[t&&(0,a.jsx)("button",{type:"button",onClick:t,className:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:w-auto","aria-label":"Cancel creating task",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:o,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 sm:w-auto","aria-busy":o,children:o?"Creating...":"Create Task"})]})]})]})}),o=(0,r.memo)(e=>{let{task:t,onDelete:s,onToggle:i}=e,[l,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(t.title),[u,m]=(0,r.useState)(t.description||""),[h,p]=(0,r.useState)(!1),{updateTask:x}=(0,n.q)(),g=async()=>{if(c.trim()){p(!0);try{await x(t.id,{title:c,description:u}),o(!1)}catch(e){}finally{p(!1)}}};return(0,a.jsx)("div",{className:"p-4",role:"listitem",children:l?(0,a.jsxs)("div",{className:"border rounded-lg p-4 bg-white shadow-sm",role:"form","aria-label":"Editing task: ".concat(t.title),children:[(0,a.jsx)("label",{htmlFor:"edit-title",className:"sr-only",children:"Task Title"}),(0,a.jsx)("input",{id:"edit-title",type:"text",value:c,onChange:e=>d(e.target.value),className:"w-full p-2 border rounded mb-2 text-gray-900",placeholder:"Task title","aria-label":"Edit task title",autoFocus:!0}),(0,a.jsx)("label",{htmlFor:"edit-description",className:"sr-only",children:"Task Description"}),(0,a.jsx)("textarea",{id:"edit-description",value:u,onChange:e=>m(e.target.value),className:"w-full p-2 border rounded mb-2 text-gray-900",placeholder:"Task description",rows:2,"aria-label":"Edit task description"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2",children:[(0,a.jsx)("button",{onClick:()=>o(!1),className:"px-3 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 sm:w-auto",disabled:h,"aria-label":"Cancel editing",children:"Cancel"}),(0,a.jsx)("button",{onClick:g,className:"px-3 py-1 text-sm bg-indigo-600 text-white rounded hover:bg-indigo-700 sm:w-auto",disabled:h,"aria-label":"Save changes",children:h?"Saving...":"Save"})]})]}):(0,a.jsx)("div",{className:"border rounded-lg p-4 shadow-sm transition-all duration-200 ".concat(t.completed?"bg-gray-50":"bg-white hover:shadow-md"),children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("input",{type:"checkbox",checked:t.completed,onChange:()=>i(t.id),className:"h-5 w-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500 mt-0.5 cursor-pointer",id:"task-checkbox-".concat(t.id),"aria-label":t.completed?'Mark task "'.concat(t.title,'" as incomplete'):'Mark task "'.concat(t.title,'" as complete')}),(0,a.jsxs)("div",{className:"ml-3 flex-1 min-w-0",children:[(0,a.jsx)("label",{htmlFor:"task-checkbox-".concat(t.id),className:"text-base font-medium block ".concat(t.completed?"text-gray-500 line-through":"text-gray-900"),children:t.title}),t.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1","aria-label":"Description: ".concat(t.description),children:t.description})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-end sm:items-center sm:space-x-2 space-y-2 sm:space-y-0",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500 self-start sm:self-auto","aria-label":"Created on ".concat(new Date(t.created_at).toLocaleDateString()),children:new Date(t.created_at).toLocaleDateString()}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>o(!0),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-50","aria-label":'Edit task "'.concat(t.title,'"'),children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),(0,a.jsx)("button",{onClick:()=>s(t.id),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-50","aria-label":'Delete task "'.concat(t.title,'"'),children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]})]})})})},(e,t)=>e.task.id===t.task.id&&e.task.title===t.task.title&&e.task.description===t.task.description&&e.task.completed===t.task.completed&&e.task.created_at===t.task.created_at&&e.task.updated_at===t.task.updated_at),c=e=>{let{size:t="md",text:s}=e;return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{className:"".concat({sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[t]," animate-spin rounded-full border-2 border-current border-t-transparent text-indigo-600"),role:"status",children:(0,a.jsx)("span",{className:"sr-only",children:"Loading..."})}),s&&(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:s})]})},d=(0,r.memo)(()=>{let{user:e,tasks:t,loadingState:s,error:i,fetchTasks:l,deleteTask:d,toggleTaskCompletion:u}=(0,n.q)(),[m,h]=(0,r.useState)("all");(0,r.useEffect)(()=>{(null==e?void 0:e.user_id)&&l()},[null==e?void 0:e.user_id]);let p=t.filter(e=>"active"===m?!e.completed:"completed"!==m||e.completed);return s.tasks&&0===t.length?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)(c,{size:"lg",text:"Loading tasks..."})}):i?(0,a.jsxs)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 mb-4",children:[(0,a.jsxs)("p",{className:"text-sm text-red-700",children:[(0,a.jsx)("span",{className:"font-medium",children:"Error:"})," ",i]}),(0,a.jsx)("button",{onClick:l,className:"mt-2 text-sm text-red-600 underline",children:"Retry"})]}):(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,a.jsxs)("div",{className:"p-4 border-b flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Tasks"}),(0,a.jsx)("div",{className:"flex space-x-2",children:["all","active","completed"].map(e=>(0,a.jsx)("button",{onClick:()=>h(e),className:"px-3 py-1 text-sm rounded-md ".concat(m===e?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700"),children:e[0].toUpperCase()+e.slice(1)},e))})]}),s.tasks&&t.length>0?(0,a.jsx)("div",{className:"p-4 flex justify-center",children:(0,a.jsx)(c,{size:"sm",text:"Updating tasks..."})}):0===p.length?(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No tasks found."}):(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("ul",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(e=>(0,a.jsx)("li",{children:(0,a.jsx)(o,{task:e,onDelete:d,onToggle:u},e.id)},e.id))})})]})});var u=()=>{let e=(0,i.useRouter)(),{user:t,loadingState:s,signOut:o}=(0,n.q)(),[c,u]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{s.auth||t||e.push("/")},[t,s.auth,e]),s.auth||!t)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Todo Dashboard"}),(0,a.jsxs)("div",{className:"flex items-center justify-between w-full sm:w-auto gap-4",children:[(0,a.jsxs)("span",{className:"text-gray-700 text-sm sm:text-base",children:["Welcome, ",t.email.split("@")[0]]}),(0,a.jsx)("button",{onClick:()=>u(!c),className:"sm:hidden bg-indigo-600 text-white px-3 py-1.5 rounded-md text-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:c?"Cancel":"+"}),(0,a.jsx)("button",{onClick:()=>{o(),e.push("/")},className:"bg-red-600 text-white px-3 py-1.5 rounded-md text-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 whitespace-nowrap",children:"Logout"})]})]})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 gap-4",children:[(0,a.jsx)("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:"Your Tasks"}),(0,a.jsx)("button",{onClick:()=>u(!c),className:"hidden sm:block bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:c?"Cancel":"Add New Task"})]}),c&&(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(l,{onClose:()=>u(!1)})}),(0,a.jsx)(d,{})]})]})}},6713:function(e,t,s){"use strict";s.d(t,{AppProvider:function(){return u},q:function(){return m}});var a=s(7821),r=s(8078),i=s(2949);class n{async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=new AbortController,a="".concat(this.baseUrl).concat(e),r={...t.headers||{}};t.body&&(r["Content-Type"]="application/json");try{let e=await fetch(a,{...t,headers:r,signal:s.signal});if(!e.ok){let t="HTTP ".concat(e.status);try{t=(await e.json()).detail||t}catch(e){}if(401===e.status)throw Error("Unauthorized");throw Error(t)}if(204===e.status)return null;return e.json()}catch(e){if("AbortError"===e.name)return;throw e}}signIn(e,t){return this.request("/auth/signin",{method:"POST",body:JSON.stringify({email:e,password:t})})}signUp(e,t){return this.request("/auth/signup",{method:"POST",body:JSON.stringify({email:e,password:t})})}signOut(){return Promise.resolve()}getTasks(e){return this.request("/tasks",{headers:{Authorization:"Bearer ".concat(e)}})}getTaskById(e,t){return this.request("/tasks/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})}createTask(e,t){return this.request("/tasks",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)})}updateTask(e,t,s){return this.request("/tasks/".concat(e),{method:"PUT",headers:{Authorization:"Bearer ".concat(s)},body:JSON.stringify(t)})}deleteTask(e,t){return this.request("/tasks/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})}toggleTaskCompletion(e,t){return this.request("/tasks/".concat(e,"/toggle"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t)}})}constructor(){var e;this.baseUrl=null!==(e=i.env.NEXT_PUBLIC_API_BASE_URL)&&void 0!==e?e:"http://127.0.0.1:8000/api"}}let l=new n,o={user:null,token:null,tasks:[],loadingState:{auth:!1,tasks:!1},error:null},c=(e,t)=>{switch(t.type){case"SET_USER":return{...e,user:t.payload.user,token:t.payload.token,error:null};case"LOGOUT":return{...o};case"SET_TASKS":return{...e,tasks:t.payload,loadingState:{...e.loadingState,tasks:!1}};case"ADD_TASK":return{...e,tasks:[...e.tasks,t.payload]};case"UPDATE_TASK":return{...e,tasks:e.tasks.map(e=>e.id===t.payload.id?t.payload:e)};case"DELETE_TASK":return{...e,tasks:e.tasks.filter(e=>e.id!==t.payload)};case"SET_LOADING":return{...e,loadingState:{...e.loadingState,[t.payload.section]:t.payload.value}};case"SET_ERROR":return{...e,error:t.payload,loadingState:{auth:!1,tasks:!1}};default:return e}},d=(0,r.createContext)(void 0),u=e=>{let{children:t}=e,[s,i]=(0,r.useReducer)(c,o);(0,r.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");if(e&&t)try{i({type:"SET_USER",payload:{token:e,user:JSON.parse(t)}})}catch(e){localStorage.clear()}},[]);let n=async(e,t)=>{i({type:"SET_LOADING",payload:{section:"auth",value:!0}});try{let s=await l.signIn(e,t);localStorage.setItem("token",s.token),localStorage.setItem("user",JSON.stringify({user_id:s.user_id,email:s.email})),i({type:"SET_USER",payload:{token:s.token,user:{user_id:s.user_id,email:s.email}}})}catch(e){throw i({type:"SET_ERROR",payload:e.message}),e}finally{i({type:"SET_LOADING",payload:{section:"auth",value:!1}})}},u=async(e,t)=>{i({type:"SET_LOADING",payload:{section:"auth",value:!0}});try{let s=await l.signUp(e,t);localStorage.setItem("token",s.token),localStorage.setItem("user",JSON.stringify({user_id:s.user_id,email:s.email})),i({type:"SET_USER",payload:{token:s.token,user:{user_id:s.user_id,email:s.email}}})}catch(e){throw i({type:"SET_ERROR",payload:e.message}),e}finally{i({type:"SET_LOADING",payload:{section:"auth",value:!1}})}},m=async()=>{if(s.token){i({type:"SET_LOADING",payload:{section:"tasks",value:!0}});try{let e=await l.getTasks(s.token);i({type:"SET_TASKS",payload:e})}catch(e){i({type:"SET_ERROR",payload:e.message})}}},h=async e=>{s.token&&i({type:"ADD_TASK",payload:await l.createTask(e,s.token)})},p=async(e,t)=>{s.token&&i({type:"UPDATE_TASK",payload:await l.updateTask(e,t,s.token)})},x=async e=>{s.token&&(await l.deleteTask(e,s.token),i({type:"DELETE_TASK",payload:e}))},g=async e=>{s.token&&i({type:"UPDATE_TASK",payload:await l.toggleTaskCompletion(e,s.token)})};return(0,a.jsx)(d.Provider,{value:{...s,signIn:n,signUp:u,signOut:()=>{localStorage.clear(),i({type:"LOGOUT"})},fetchTasks:m,createTask:h,updateTask:p,deleteTask:x,toggleTaskCompletion:g},children:t})},m=()=>{let e=(0,r.useContext)(d);if(!e)throw Error("useApp must be used inside AppProvider");return e}},8504:function(e,t,s){"use strict";var a=s(3226);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},2949:function(e,t,s){"use strict";var a,r;e.exports=(null==(a=s.g.process)?void 0:a.env)&&"object"==typeof(null==(r=s.g.process)?void 0:r.env)?s.g.process:s(3862)},3862:function(e){!function(){var t={229:function(e){var t,s,a,r=e.exports={};function i(){throw Error("setTimeout has not been defined")}function n(){throw Error("clearTimeout has not been defined")}function l(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(s){try{return t.call(null,e,0)}catch(s){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{s="function"==typeof clearTimeout?clearTimeout:n}catch(e){s=n}}();var o=[],c=!1,d=-1;function u(){c&&a&&(c=!1,a.length?o=a.concat(o):d=-1,o.length&&m())}function m(){if(!c){var e=l(u);c=!0;for(var t=o.length;t;){for(a=o,o=[];++d<t;)a&&a[d].run();d=-1,t=o.length}a=null,c=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===n||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];o.push(new h(e,t)),1!==o.length||c||l(m)},h.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},s={};function a(e){var r=s[e];if(void 0!==r)return r.exports;var i=s[e]={exports:{}},n=!0;try{t[e](i,i.exports,a),n=!1}finally{n&&delete s[e]}return i.exports}a.ab="//";var r=a(229);e.exports=r}()}},function(e){e.O(0,[115,364,744],function(){return e(e.s=8986)}),_N_E=e.O()}]);